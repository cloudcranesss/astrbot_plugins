# AstrBot JMComic 签到插件 (astrbot_plugin_jm_sign)

一个用于 AstrBot 的 JMComic (18Comic) 自动签到插件。支持多账号、自动获取最新域名、定时任务和详细的个人资料展示。

## ✨ 功能特点

*   **自动签到**：每日自动完成签到任务，获取 J Coins。
*   **多账号支持**：支持配置无限个账号，批量流水线执行。
*   **智能寻路**：自动轮询多个发布页（如 `jmcomicne.net`）获取最新的有效国内/国际域名，无惧域名屏蔽。
*   **定时任务**：集成 `APScheduler`，支持标准的 Cron 表达式，实现全自动挂机签到。
*   **详细报告**：签到成功后自动抓取并展示用户资料（等级、经验进度、金币数、可收藏上限、称号等）。
*   **权限控制**：支持指令白名单，仅允许指定用户触发签到指令。

## 🛠️ 安装与配置

### 1. 安装

将本插件文件夹放置在 AstrBot 的 `data/plugins/` 目录下。

### 2. 依赖安装

插件依赖 `apscheduler` 和 `aiohttp`。AstrBot 启动时会自动尝试安装 `requirements.txt` 中的依赖。如果失败，请手动运行：

```bash
pip install apscheduler aiohttp
```

### 3. 配置说明

请在 AstrBot 的 Web 管理界面（插件配置）中填写以下信息：

| 配置项 | 类型 | 说明 | 默认值/示例 |
| :--- | :--- | :--- | :--- |
| **accounts** | List | **[必填]** 账号列表。在 WebUI 中点击添加，格式为 `用户名:密码`。也支持直接编辑文本配置，格式为 `user@pass` (每行一个)。 | `test_user:123456` |
| **domain** | String | (可选) 指定 JMComic 域名。建议**留空**，插件会自动获取最新可用域名。 | `https://18comic.vip` |
| **enable_cron** | Bool | 是否启用定时自动签到。 | `false` |
| **cron_expression** | String | 定时任务的 Cron 表达式 (格式：`分 时 日 月 周`)。 | `0 8 * * *` (每天上午8点) |
| **whitelist_users** | List | 指令权限白名单。填入允许执行 `/jmsign` 的 User ID (字符串)。**留空则允许所有人使用**。 | `["123456789"]` |

## 🚀 使用方法

### 手动触发

发送指令：

```
/jmsign
```

插件将自动获取最新域名，并遍历配置的所有账号进行登录和签到，最后回复一份包含所有账号状态和详细个人资料的汇总报告。

### 定时任务

1.  在配置中开启 `enable_cron`。
2.  设置 `cron_expression`（例如 `30 8 * * *` 表示每天 08:30）。
3.  重载插件。
4.  插件将在后台自动执行签到任务并记录日志（定时任务不会主动向聊天窗口推送消息，以免打扰）。

## 📝 效果预览

```text
=== JMComic 批量签到报告 ===

用户: Alanmaster
✅ 签到操作完成
域名: https://jm18c-oec.cc
结果: 今天已经签到过了 (finished)

👤 用户: Alanmaster
🔰 等级: Lv.8 | 💰 23,262
⭐ 可收藏: 1,200 | 📈 经验: 18603/28350
🏷️ 称号: 蕴含的太阳
```

## ⚠️ 免责声明

*   本插件仅供 Python 编程学习和交流使用。
*   请勿用于任何非法商业用途或恶意攻击服务器。
*   使用本插件产生的任何后果由使用者自行承担。
